<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Criteria Issue Finder & Keyword Scanner</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
:root {
  --bg: #0f172a; --bg-elevated: #020617; --card: #020617;
  --accent: #38bdf8; --accent-soft: rgba(56, 189, 248, 0.15);
  --border-subtle: #1e293b; --text-main: #e5e7eb; --text-muted: #94a3b8; --text-soft: #64748b;
  --radius-lg: 16px; --radius-xl: 22px; --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.75);
  --crit-bg: rgba(255, 205, 0, 0.35); --crit-text: #b59f00;
}
.light { --bg:#f1f5f9; --bg-elevated:#fff; --card:#fff; --accent:#0284c7; --accent-soft: rgba(2,132,199,0.15); --text-main:#0f172a; --text-muted:#475569; --text-soft:#64748b; --crit-bg: rgba(255,225,100,0.35); --crit-text:#b59f00; }
.crit-kw { background: var(--crit-bg); color: var(--crit-text); font-weight:700; padding:0 3px; border-radius:3px; }
.copy-btn { margin-left:4px; font-size:0.75rem; padding:2px 6px; border-radius:8px; border:none; background: var(--accent); color:white; cursor:pointer; transition: background 0.2s; }
.copy-btn:hover { filter: brightness(0.85); }
body { margin:0; padding:0; font-family:system-ui, sans-serif; background: var(--bg); color: var(--text-main); min-height:100vh; display:flex; justify-content:center; }
.shell { max-width:1250px; width:100%; padding:24px; display:flex; flex-direction:column; gap:20px; }
.panel { background: var(--card); border-radius:22px; border:1px solid var(--border-subtle); padding:18px; box-shadow:0 18px 45px rgba(15,23,42,0.75); display:flex; flex-direction:column; gap:14px; }
.criterion-card { border-radius:16px; border:1px solid var(--border-subtle); background: var(--bg-elevated); padding:12px; margin-bottom:8px; }
.criterion-label { font-weight:700; color: var(--accent); }
.context-list { margin:6px 0 0; padding-left:16px; font-size:0.82rem; }
</style>
</head>
<body>
<div class="shell">
  <section class="panel">
    <h2>Paste Feedback</h2>
    <textarea id="inputText" placeholder="Paste feedback here..." rows="8"></textarea>
    <button id="analyzeButton">Analyze</button>
  </section>
  <section class="panel">
    <h2>Results</h2>
    <div id="resultsContainer"></div>
  </section>
</div>
<script>
const inputEl = document.getElementById("inputText");
const analyzeBtn = document.getElementById("analyzeButton");
const resultsContainer = document.getElementById("resultsContainer");
const cPattern = /\b(?:C|Criteria|Criterion)[\s-]*(\d+)\b/gi;

function escapeHtml(text){ return text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"); }

function renderCriteria(text){
  resultsContainer.innerHTML = "";
  const lines = text.split(/\r?\n/).filter(l=>l.trim());
  const critMap = new Map();

  lines.forEach(line=>{
    let match;
    while((match=cPattern.exec(line))!==null){
      const critNumber = match[1];
      const label = `C${critNumber}`;
      if(!critMap.has(label)) critMap.set(label, []);
      critMap.get(label).push(line);
    }
  });

  critMap.forEach((lines, criterion)=>{
    const card = document.createElement("div");
    card.className="criterion-card";
    card.innerHTML = `<div class="criterion-label">${criterion}</div><ul class="context-list"></ul>`;
    const ul = card.querySelector("ul");

    lines.forEach(line=>{
      const li = document.createElement("li");
      let lastIndex = 0;
      const frag = document.createDocumentFragment();
      const regex = new RegExp(`\\b(?:C|Criteria|Criterion)[\\s-]*${criterion.replace('C','')}\\b`, "gi");
      let m;
      while((m = regex.exec(line)) !== null){
        if(m.index > lastIndex){
          frag.appendChild(document.createTextNode(line.slice(lastIndex, m.index)));
        }
        const span = document.createElement("span");
        span.className="crit-kw";
        span.textContent = m[0];
        frag.appendChild(span);

        const btn = document.createElement("button");
        btn.className="copy-btn";
        btn.textContent="Copy";
        btn.onclick = () => navigator.clipboard.writeText(line);
        frag.appendChild(btn);

        lastIndex = m.index + m[0].length;
      }
      if(lastIndex < line.length){
        frag.appendChild(document.createTextNode(line.slice(lastIndex)));
      }
      li.appendChild(frag);
      ul.appendChild(li);
    });

    resultsContainer.appendChild(card);
  });
}

analyzeBtn.addEventListener("click",()=>{ renderCriteria(inputEl.value); });
</script>
</body>
</html>
